---
layout: post
title: 스테이지 난이도 마법사 With Google Analytics
author: 황찬주
date: 2014-09-22
---
#“스테이지 난이도 마법사”란?
*기획자가 의도한 난이도를 유저 행동 로그로 자동으로 맞춰주는 것*을 목표로 만든 시스템이다.
이 시스템을 만들기 위해 분석된 유저의 행동을 반영할 수 있는 스테이지 난이도 시스템이 우선 필요했다.

###분석 레벨링을 위한 스테이지 난이도 시스템 (Base System)
* 분석을 최대한 빠르게 적용하기
> 게임 개발에 에서 분석의 가장 큰 문제는 ‘분석’과 ‘적용’ 사이의 시간이 너무 긴 것이다. 이번 프로젝트는 게임을 개발할 때는 초반부터 이 시간을 줄이기 위해 고민을 했다. 초기 레벨 디자인 단계부터 분석을 수치화 하고 수치화된 상수를 넣으면 난이도가 바뀔 수 있도록 디자인을 했다.

####전체 난이도
1. 플레이어 1레벨에서 적당한 난이도를 느낄 수 있는 몬스터 능력치 Min, Max를 설정.
2. 플레어어와 비슷한 공식으로 레벨에 따라 높아지는 몬스터 공식(or 테이블)을 생성
![몬스터 능력치](/img/posts/2014-09-22-Level_design_wizard_withGA/monsterLevelset.png)
3. 스테이지에 처음 진입 하는 플레이어 레벨을 게임에서 주는 경험치로 역산
4. 진입 레벨(스테이지)에 따라 몬스터 자동 생성

####스테이지 난이도.
1. 스테이지 마다 상수로 난이도를 조정
![스테이지 난이도표](/img/posts/2014-09-22-Level_design_wizard_withGA/levelbyStage.png)

간단히 표현을 하면 다음과 같아진다.
![난이도표](/img/posts/2014-09-22-Level_design_wizard_withGA/sampleLeveldesign.png)

**전체 난이도 1,2번**에 공을 들이면 프로토타입용 난이도 설정은 굉장히 간단해진다. 이후 스테이지의 특징만 잘 잡아주면 된다. 이제 진입 레벨과, 가중치만으로 스테이지 난이도를 조정할 수 있게 되었다. 이제 분석이 빠르게 적용될 수 있게 시스템을 만들어보자.

###유저 행동에 따라 자동으로 바뀌는 난이도 
#### With Google Analytics 이하 GA
> GA에 로그를 잘 넣어어 놨다면 (*방법은 이번 포스팅에 다루지 않는다.*) 스프레드 시트를 통해 다음의 데이터를 준 실시간(4시간 정도)으로 볼 수 있다.
![스프레드시트](/img/posts/2014-09-22-Level_design_wizard_withGA/GAspreadsheet.png)
#### 유저의 체감 난이도 확인법 
 전체 난이도를 설정할 때 반복되는 테스트로 개발팀은 원하던 원하지 않던 개발되는 게임의 고수가 된다. 개발할 때는 ‘적당한 난이도’로 괜찮지만 오픈 이후는 이 난이도를 정의 해야한다. 이 경우 60 ~ 80%의 클리어율로 난이도를 적용해보자. 즉, (의도적으로 올린게 아닌 자동화로 뽑힌 맵의 경우) 유저의 클리어율에 따라 난이도를 수정할 수 있게 만든다.
![클리어율](/img/posts/2014-09-22-Level_design_wizard_withGA/ClearRate.png)
스테이지에 따른 유저의 결과를 로그로 만든 그래프이다.

#### 기획의도 대로 난이도가 잘 나왔는가?
![가중치와 클리어율 비교](/img/posts/2014-09-22-Level_design_wizard_withGA/GA1)

#### 진입 레벨은 초반 설정과 같은가?
![진입 레벨 확인](/img/posts/2014-09-22-Level_design_wizard_withGA/GA2.png)
> X축 진입 레벨, Y축 스테이지 난이도 (붉은 색: 행의 최빈값 1~5위)

실제 데이터를 바탕으로 난이도를 준 실시간으로 관찰할 수 있다. 
난이도 수정 방법은 스테이지 시작시 가중치와 진입 난이도만 유저의 행동을 서버에서 읽어 오거나 하루에 한번 업데이트가 된다면, 유저 반응에 따른 난이도를 손 쉽게 수정할 수 있다.

 이렇게 초반의 개발자의 실력, 개발자의 판단에 의해서 맞추어졌던 난이도를 유저 행동에 의해 기획의도에 맞게 지속적으로 수정되는 모델을 만들 수 있다.

### GA의 장점
이런 분석을 다양한 분석툴이 많음에도 GA를 사용하였는데 개인적인 장점은 다음과 같다. 

1. 보기 간편하다.
> 서버에 남겼다면 파일을 처음부터 분리애햐 했고, 로그가 남으면 서버 접근 권한이 있는 개발자에게 부탁하고, 메모장으로 받아서 무결성 검사를 하고, DB에 밀어 넣어서 쿼리를 통해 분석을 하지만 간단한 GA 사용법만 안다면 위 과정이 필요 없다.

2. 공유 및 보고서 작성이 편하다.
> 스프레드시트로 데이터를 바로 뺄 수 있어서 그래프, 및 다양한 수치를 보는 것이 편하다.

3. 기본으로 제공되는 다양함.
> 이건 [강규영님의 글](http://boxnwhis.kr/2014/09/15/analyze_game_using_ga_1.html)을 보면 된다.

“개인의 실력에 따라 바뀌는 난이도 시스템 디자인” 은 다음 포스팅으로!
 
